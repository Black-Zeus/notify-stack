<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!--[if mso]>
  <style type="text/css">
    body, table, td {font-family: Arial, sans-serif !important;}
  </style>
  <![endif]-->
</head>

<body style="margin:0; padding:0; background-color:#f4f4f4; font-family:Arial, sans-serif;">

  <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" bgcolor="#f4f4f4">
    <tr>
      <td align="center" style="padding:20px 0;">

        <!-- Container -->
        <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="600" bgcolor="#ffffff" style="border-collapse:collapse;">

          <!-- Header -->
          <tr>
            <td align="center" bgcolor="#db2777" style="padding:20px;">
              <h1 style="margin:0; font-size:24px; font-weight:bold; color:#ffffff;">üåê ALERTA DE RED</h1>
            </td>
          </tr>

          <!-- Content -->
          <tr>
            <td bgcolor="#f8f9fa" style="padding:30px 20px;">

              <!-- Alert box -->
              <table role="presentation" width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#fdf2f8" style="border:2px solid #db2777;">
                <tr>
                  <td style="padding:20px; font-size:16px; color:#333333; line-height:1.5;">
                    <strong>Se ha detectado un problema de conectividad:</strong>
                  </td>
                </tr>
                <tr>
                  <td style="padding:0 20px 20px 20px;">
                    <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="border-collapse:collapse;">
                      <tr>
                        <td style="padding:6px 10px; font-weight:bold; color:#555555;" width="35%">Tipo de alerta:</td>
                        <td style="padding:6px 10px; font-weight:bold; color:#db2777;">{{ tipo_alerta }}</td>
                      </tr>
                      <tr>
                        <td style="padding:6px 10px; font-weight:bold; color:#555555;">Destino afectado:</td>
                        <td style="padding:6px 10px; font-weight:bold; color:#db2777;">{{ destino_afectado }}</td>
                      </tr>
                      <tr>
                        <td style="padding:6px 10px; font-weight:bold; color:#555555;">Severidad:</td>
                        <td style="padding:6px 10px;">
                          {% if severidad == 'critical' -%}
                          <span style="background-color:#dc2626; color:#ffffff; padding:4px 12px; font-size:14px; font-weight:bold; display:inline-block;">CR√çTICA</span>
                          {% elif severidad == 'high' -%}
                          <span style="background-color:#ea580c; color:#ffffff; padding:4px 12px; font-size:14px; font-weight:bold; display:inline-block;">ALTA</span>
                          {% elif severidad == 'medium' -%}
                          <span style="background-color:#ca8a04; color:#ffffff; padding:4px 12px; font-size:14px; font-weight:bold; display:inline-block;">MEDIA</span>
                          {% else -%}
                          <span style="background-color:#16a34a; color:#ffffff; padding:4px 12px; font-size:14px; font-weight:bold; display:inline-block;">BAJA</span>
                          {% endif %}
                        </td>
                      </tr>
                      <tr>
                        <td style="padding:6px 10px; font-weight:bold; color:#555555;">Detecci√≥n:</td>
                        <td style="padding:6px 10px; font-weight:bold; color:#db2777;">{{ hora_deteccion }}</td>
                      </tr>
                      <tr>
                        <td style="padding:6px 10px; font-weight:bold; color:#555555;">Monitor:</td>
                        <td style="padding:6px 10px; font-weight:bold; color:#db2777;">{{ servidor_monitor }}</td>
                      </tr>
                      <tr>
                        <td style="padding:6px 10px; font-weight:bold; color:#555555;">ID del evento:</td>
                        <td style="padding:6px 10px;"><span style="font-family:monospace; background-color:#f3f4f6; padding:2px 6px; font-size:14px;">{{ evento_id }}</span></td>
                      </tr>
                    </table>
                  </td>
                </tr>
              </table>

              {% if latencia_alta -%}
              <!-- Latencia alta -->
              <table role="presentation" width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#f8fafc" style="border:2px solid #64748b; margin-top:15px;">
                <tr>
                  <td style="padding:15px; font-size:16px; font-weight:bold; color:#1f2937;">‚ö° Latencia Alta Detectada</td>
                </tr>
                <tr>
                  <td style="padding:0 15px 15px 15px;">
                    <table role="presentation" width="100%" border="0" cellspacing="0" cellpadding="0">
                      <tr>
                        <td style="padding:6px 10px; font-weight:bold; color:#555555;" width="35%">Latencia actual:</td>
                        <td style="padding:6px 10px; font-weight:bold; color:#0f172a;">{{ latencia_actual }}ms</td>
                      </tr>
                      <tr>
                        <td style="padding:6px 10px; font-weight:bold; color:#555555;">Latencia promedio:</td>
                        <td style="padding:6px 10px; font-weight:bold; color:#0f172a;">{{ latencia_promedio }}ms</td>
                      </tr>
                      <tr>
                        <td style="padding:6px 10px; font-weight:bold; color:#555555;">Umbral configurado:</td>
                        <td style="padding:6px 10px; font-weight:bold; color:#0f172a;">{{ umbral_latencia }}ms</td>
                      </tr>
                      {% if duracion_problema -%}
                      <tr>
                        <td style="padding:6px 10px; font-weight:bold; color:#555555;">Duraci√≥n:</td>
                        <td style="padding:6px 10px; font-weight:bold; color:#0f172a;">{{ duracion_problema }}</td>
                      </tr>
                      {% endif %}
                      {% if perdida_paquetes -%}
                      <tr>
                        <td style="padding:6px 10px; font-weight:bold; color:#555555;">P√©rdida de paquetes:</td>
                        <td style="padding:6px 10px; font-weight:bold; color:#0f172a;">{{ perdida_paquetes }}%</td>
                      </tr>
                      {% endif %}
                    </table>

                    <!-- Barra de latencia -->
                    <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="margin-top:10px; border-collapse:collapse;">
                      <tr>
                        <td width="{% if latencia_actual|int >= 1000 %}100{% else %}{{ (latencia_actual|int / 1000 * 100)|int }}{% endif %}%" bgcolor="{% if latencia_actual|int >= 1000 %}#dc2626{% elif latencia_actual|int >= 500 %}#f59e0b{% else %}#10b981{% endif %}" height="20">&nbsp;</td>
                        <td width="{% if latencia_actual|int >= 1000 %}0{% else %}{{ 100 - (latencia_actual|int / 1000 * 100)|int }}{% endif %}%" bgcolor="#e5e7eb" height="20">&nbsp;</td>
                      </tr>
                    </table>
                  </td>
                </tr>
              </table>
              {% endif %}

              {% if dns_fallo -%}
              <!-- Fallo DNS -->
              <table role="presentation" width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#f8fafc" style="border:2px solid #64748b; margin-top:15px;">
                <tr>
                  <td style="padding:15px; font-size:16px; font-weight:bold; color:#1f2937;">üîç Fallo en Resoluci√≥n DNS</td>
                </tr>
                <tr>
                  <td style="padding:0 15px 15px 15px;">
                    <table role="presentation" width="100%" border="0" cellspacing="0" cellpadding="0">
                      <tr>
                        <td style="padding:6px 10px; font-weight:bold; color:#555555;">Dominio:</td>
                        <td style="padding:6px 10px; font-weight:bold; color:#0f172a;">{{ dominio_dns }}</td>
                      </tr>
                      <tr>
                        <td style="padding:6px 10px; font-weight:bold; color:#555555;">Servidor DNS:</td>
                        <td style="padding:6px 10px; font-weight:bold; color:#0f172a;">{{ servidor_dns }}</td>
                      </tr>
                    </table>
                  </td>
                </tr>
              </table>
              {% endif %}

              {% if impacto_servicios -%}
              <!-- Servicios impactados -->
              <table role="presentation" width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#fef3c7" style="border:2px solid #f59e0b; margin-top:15px;">
                <tr>
                  <td style="padding:20px; font-size:16px; color:#333333; line-height:1.5;">
                    <strong>‚ö†Ô∏è Servicios impactados:</strong><br>
                    {{ servicios_impactados }}
                  </td>
                </tr>
              </table>
              {% endif %}

              {% if accion_recomendada -%}
              <!-- Acciones recomendadas -->
              <table role="presentation" width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#fef3c7" style="border:2px solid #f59e0b; margin-top:15px;">
                <tr>
                  <td style="padding:20px; font-size:16px; color:#333333; line-height:1.5;">
                    <strong>üí° Acciones recomendadas:</strong><br>
                    {{ accion_recomendada }}
                  </td>
                </tr>
              </table>
              {% endif %}

            </td>
          </tr>

          <!-- Footer -->
          <tr>
            <td align="center" bgcolor="#f8f9fa" style="padding:15px 20px; border-top:1px solid #dee2e6;">
              <p style="margin:0; font-size:12px; color:#6c757d; line-height:1.4;">
                Este es un mensaje autom√°tico del sistema de monitoreo de red.<br>
                Generado el {{ timestamp }} por Notify API
              </p>
            </td>
          </tr>

        </table>
      </td>
    </tr>
  </table>

</body>
</html>
